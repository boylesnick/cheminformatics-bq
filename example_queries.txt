This is a collection of example queries that use the cheminformatics package to query publically available datasets. 

The data we'll query is from the table: nih-nci-cbiit-chem-prod.savi.plus , which is 2.05 TB and contains 1,094,782,440 chemical compounds. 

In the following queries, you just need to replace the name of the target table to match your project, dataset and table name. 

Fingerprint all of SAVI:
-----------------------

create or replace table `life-sciences-333615.chemistry.savi_fingerprint_all` as
(
SELECT product_smiles,
`cheminformatics.rdkit_pattern_fingerprint`(product_smiles) as pattern_fingerprint,
from `nih-nci-cbiit-chem-prod.savi.plus` TABLESAMPLE SYSTEM (100 percent)
)

Fingperint 1% of SAVI:
----------------------

create or replace table `life-sciences-333615.chemistry.savi_fingerprint_1_percent` as
(
SELECT product_smiles,
`cheminformatics.rdkit_pattern_fingerprint`(product_smiles) as pattern_fingerprint,
from `nih-nci-cbiit-chem-prod.savi.plus` TABLESAMPLE SYSTEM (1 percent)
)

Fingerprint and Generate Molecular Descriptors for all of SAVI:
---------------------------------------------------------------

create or replace table `life-sciences-333615.chemistry.savi_fingerprint_and_descriptors` as
(
SELECT product_smiles,
`cheminformatics.rdkit_pattern_fingerprint`(product_smiles) as pattern_fingerprint,
`cheminformatics.rdkit_generate_maccs_keys`(product_smiles) as maccs_key,
`cheminformatics.rdkit_smiles_to_inchi`(product_smiles) as rdkit_inchi,
`cheminformatics.rdkit_qed`(product_smiles) as rdkit_qed,
`cheminformatics.rdkit_draw_svg`(product_smiles) as rdkit_svg,
`cheminformatics.rdkit_descriptor_exact_mol_wt`(product_smiles) as mol_wt,
`cheminformatics.rdkit_descriptor_fraction_csp3`(product_smiles) as fraction_csp3,
`cheminformatics.rdkit_descriptor_mol_log_p`(product_smiles) as mol_log_p,
from `nih-nci-cbiit-chem-prod.savi.plus` TABLESAMPLE SYSTEM (100 percent)
)
